<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>SpectralKit · SpectralKit.jl</title><meta name="title" content="SpectralKit · SpectralKit.jl"/><meta property="og:title" content="SpectralKit · SpectralKit.jl"/><meta property="twitter:title" content="SpectralKit · SpectralKit.jl"/><meta name="description" content="Documentation for SpectralKit.jl."/><meta property="og:description" content="Documentation for SpectralKit.jl."/><meta property="twitter:description" content="Documentation for SpectralKit.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>SpectralKit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>SpectralKit</a><ul class="internal"><li><a class="tocitem" href="#Concepts"><span>Concepts</span></a></li><li><a class="tocitem" href="#Univariate-basis-example"><span>Univariate basis example</span></a></li><li><a class="tocitem" href="#Multivariate-(Smolyak)-approximation-example"><span>Multivariate (Smolyak) approximation example</span></a></li><li><a class="tocitem" href="#Infinite-endpoints"><span>Infinite endpoints</span></a></li><li><a class="tocitem" href="#Constructing-bases"><span>Constructing bases</span></a></li><li><a class="tocitem" href="#Using-bases"><span>Using bases</span></a></li><li><a class="tocitem" href="#Derivatives"><span>Derivatives</span></a></li><li><a class="tocitem" href="#Internals"><span>Internals</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>SpectralKit</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>SpectralKit</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/tpapp/SpectralKit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/tpapp/SpectralKit.jl/blob/master/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="SpectralKit"><a class="docs-heading-anchor" href="#SpectralKit">SpectralKit</a><a id="SpectralKit-1"></a><a class="docs-heading-anchor-permalink" href="#SpectralKit" title="Permalink"></a></h1><p>This is a very simple package for <em>building blocks</em> of spectral methods. Its intended audience is users who are familiar with the theory and practice of these methods, and prefer to assemble their code from modular building blocks, potentially reusing calculations. If you need an introduction, a book like <em>Boyd (2001): Chebyshev and Fourier spectral methods</em> is a good place to start.</p><p>This package was designed primarily for solving functional equations, as usually encountered in economics when solving discrete and continuous-time problems. Key features include</p><ol><li>evaluation of univariate and multivatiate basis functions, including Smolyak combinations,</li><li>transformed to the relevant domains of interest, eg <span>$[a,b] × [0,∞)$</span>,</li><li>(partial) derivatives, with correct limits at endpoints,</li><li>allocation-free, thread safe linear combinations for the above with a given set of coefficients,</li><li>using <a href="https://github.com/JuliaArrays/StaticArrays.jl">static arrays</a> extensively to avoid allocation and unroll <em>some</em> loops.</li></ol><p>While there is some functionality in this package to <em>fit</em> approximations to existing functions, it does not use optimized algorithms (DCT) for that, as it was optimized for mapping a set of coefficients to residuals of functional equations at gridpoints.</p><p>Also, while the package should interoperate seamlessly with most AD frameworks, only the derivative API (explained below) is guaranteed to have correct derivatives of limits near infinity.</p><h2 id="Concepts"><a class="docs-heading-anchor" href="#Concepts">Concepts</a><a id="Concepts-1"></a><a class="docs-heading-anchor-permalink" href="#Concepts" title="Permalink"></a></h2><p>In this package,</p><ol><li><p>A <em>basis</em> is a finite family of functions for approximating other functions. The <a href="#SpectralKit.dimension"><code>dimension</code></a> of a basis tells you how many functions are in there, while <a href="#SpectralKit.domain"><code>domain</code></a> can be used to query its domain.</p></li><li><p>A <a href="#SpectralKit.grid"><code>grid</code></a> is vector of <em>suggested</em> gridpoints for evaluating the function to be approximated that has useful theoretical properties. You can contruct a <a href="#SpectralKit.collocation_matrix"><code>collocation_matrix</code></a> using this grid (or any other set of points). Grids are associated with bases at the time of their construction: a basis with the same set of functions can have different grids.</p></li><li><p><a href="#SpectralKit.basis_at"><code>basis_at</code></a> returns an <em>iterator</em> for evaluating basis functions at an arbitrary point inside their domain. This iterator is meant to be heavily optimized and non-allocating. <a href="#SpectralKit.linear_combination"><code>linear_combination</code></a> is a convenience wrapper for obtaining a linear combination of basis functions at a given point.</p></li></ol><h2 id="Univariate-basis-example"><a class="docs-heading-anchor" href="#Univariate-basis-example">Univariate basis example</a><a id="Univariate-basis-example-1"></a><a class="docs-heading-anchor-permalink" href="#Univariate-basis-example" title="Permalink"></a></h2><p>We construct a basis of Chebyshev polynomials on <span>$[0, 4]$</span>. This requires a transformation since their canonical domain is <span>$[-1,1]$</span>. Other transformations include <a href="#SpectralKit.SemiInfRational"><code>SemiInfRational</code></a> for <span>$[A, \infty]$</span> intervals  and <a href="#SpectralKit.InfRational"><code>InfRational</code></a> for <span>$[-\infty, \infty]$</span> intervals.</p><p>We display the domian and the dimension (number of basis functions).</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using SpectralKit</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; basis = Chebyshev(InteriorGrid(), 5) ∘ BoundedLinear(0, 4)</code><code class="nohighlight hljs ansi" style="display:block;">SpectralKit.TransformedBasis{Chebyshev{InteriorGrid}, BoundedLinear{Float64}}(Chebyshev polynomials (1st kind), InteriorGrid(), dimension: 5, (0.0,4.0) ↔ domain [linear transformation])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; domain(basis)</code><code class="nohighlight hljs ansi" style="display:block;">[0.0,4.0]</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; dimension(basis)</code><code class="nohighlight hljs ansi" style="display:block;">5</code></pre><p>We have chosen an interior grid, shown below. We <code>collect</code> the result for the purpose of this tutorial, since <code>grid</code> returns an iterable to avoid allocations.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; collect(grid(basis))</code><code class="nohighlight hljs ansi" style="display:block;">5-element Vector{Float64}:
 3.9021130325903073
 3.1755705045849463
 2.0
 0.8244294954150537
 0.09788696740969272</code></pre><p>We can show evaluate the basis functions at a given point. Again, it is an iterable, so we <code>collect</code> to show it here.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; collect(basis_at(basis, 0.41))</code><code class="nohighlight hljs ansi" style="display:block;">5-element Vector{Float64}:
  1.0
 -0.795
  0.2640500000000001
  0.37516049999999984
 -0.8605551949999999</code></pre><p>We can evaluate linear combination as directly, or via partial application.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; θ = [1, 0.5, 0.2, 0.3, 0.001];           # a vector of coefficients</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; x = 0.41</code><code class="nohighlight hljs ansi" style="display:block;">0.41</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; linear_combination(basis, θ, x)          # combination at some value</code><code class="nohighlight hljs ansi" style="display:block;">0.7669975948050001</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; linear_combination(basis, θ)(x)          # also as a callable</code><code class="nohighlight hljs ansi" style="display:block;">0.7669975948050001</code></pre><p>We can also evaluate <em>derivatives</em> of either the basis or the linear combination at a given point. Here we want the derivatives up to order 3.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; dx = (𝑑^2)(x)</code><code class="nohighlight hljs ansi" style="display:block;">0.41 + 1.0⋅Δ + 0.0⋅Δ²</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; collect(basis_at(basis, dx))</code><code class="nohighlight hljs ansi" style="display:block;">5-element Vector{SpectralKit.𝑑Expansion{3, Float64}}:
 1.0 + 0.0⋅Δ + 0.0⋅Δ²
 -0.795 + 0.5⋅Δ + 0.0⋅Δ²
 0.2640500000000001 + -1.59⋅Δ + 1.0⋅Δ²
 0.37516049999999984 + 2.2921500000000004⋅Δ + -4.7700000000000005⋅Δ²
 -0.8605551949999999 + -1.6793580000000008⋅Δ + 11.168600000000001⋅Δ²</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; fdx = linear_combination(basis, θ, dx)</code><code class="nohighlight hljs ansi" style="display:block;">0.7669975948050001 + 0.617965642⋅Δ + -1.2198314000000001⋅Δ²</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; fdx[0] # the value</code><code class="nohighlight hljs ansi" style="display:block;">0.7669975948050001</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; fdx[1] # the first derivative</code><code class="nohighlight hljs ansi" style="display:block;">0.617965642</code></pre><p>Having an approximation, we can embed it in a larger basis, extending the coefficients accordingly.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; basis2 = Chebyshev(EndpointGrid(), 8) ∘ transformation(basis)       # 8 Chebyshev polynomials</code><code class="nohighlight hljs ansi" style="display:block;">SpectralKit.TransformedBasis{Chebyshev{EndpointGrid}, BoundedLinear{Float64}}(Chebyshev polynomials (1st kind), EndpointGrid(), dimension: 8, (0.0,4.0) ↔ domain [linear transformation])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; is_subset_basis(basis, basis2)              # we could augment θ …</code><code class="nohighlight hljs ansi" style="display:block;">true</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; augment_coefficients(basis, basis2, θ)      # … so let&#39;s do it</code><code class="nohighlight hljs ansi" style="display:block;">8-element Vector{Float64}:
 1.0
 0.5
 0.2
 0.3
 0.001
 0.0
 0.0
 0.0</code></pre><h2 id="Multivariate-(Smolyak)-approximation-example"><a class="docs-heading-anchor" href="#Multivariate-(Smolyak)-approximation-example">Multivariate (Smolyak) approximation example</a><a id="Multivariate-(Smolyak)-approximation-example-1"></a><a class="docs-heading-anchor-permalink" href="#Multivariate-(Smolyak)-approximation-example" title="Permalink"></a></h2><p>We set up a Smolyak basis to approximate functions on <span>$[-1,2] \times [-3, \infty]$</span>, where the second dimension has a scaling of <span>$3$</span>.</p><pre><code class="language-julia hljs">using SpectralKit, StaticArrays
basis = smolyak_basis(Chebyshev, InteriorGrid2(), SmolyakParameters(3), 2)
ct = coordinate_transformations(BoundedLinear(-1, 2.0), SemiInfRational(-3.0, 3.0))
basis_t = basis ∘ ct</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralKit.TransformedBasis{SpectralKit.SmolyakBasis{SpectralKit.SmolyakIndices{2, 15, 3, 3, 4}, Chebyshev{InteriorGrid2}}, SpectralKit.CoordinateTransformations{Tuple{BoundedLinear{Float64}, SemiInfRational{Float64}}}}(Sparse multivariate basis on ℝ²
  Smolyak indexing, ∑bᵢ ≤ 3, all bᵢ ≤ 3, dimension 49
  using Chebyshev polynomials (1st kind), InteriorGrid2(), dimension: 15, coordinate transformations
  (-1.0,2.0) ↔ domain [linear transformation]
  (-3.0,∞) ↔ domain [rational transformation with scale 3.0])</code></pre><p>Note how the basis can be combined with a transformation using <code>∘</code>.</p><p>We will approximate the following function:</p><pre><code class="language-julia hljs">f2((x1, x2)) = exp(x1) + exp(-abs2(x2))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">f2 (generic function with 1 method)</code></pre><p>We find the coefficients by solving with the collocation matrix.</p><pre><code class="language-julia hljs">θ = collocation_matrix(basis_t) \ f2.(grid(basis_t))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">49-element Vector{Float64}:
  2.7793220217324706
  3.2369886430572143
  1.1139902424577899
  0.2663479965030996
  0.04859825644525028
  0.007157295461750643
  0.0008829533666788979
  9.366852829718765e-5
  8.713768913578302e-6
  7.216598510789816e-7
  ⋮
 -2.8429038809505643e-16
  0.03010775018319918
  0.048411759340962084
 -0.03222472955157677
 -0.16530952363028062
  0.01639663318432438
  0.012259562724398244
 -0.01591087240587917
 -0.14085219047438763</code></pre><p>Finally, we check the approximation at a point.</p><pre><code class="language-julia hljs">z = (0.5, 0.7)                            # evaluate at this point
isapprox(f2(z), linear_combination(basis_t, θ)(z), rtol = 0.005)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><h2 id="Infinite-endpoints"><a class="docs-heading-anchor" href="#Infinite-endpoints">Infinite endpoints</a><a id="Infinite-endpoints-1"></a><a class="docs-heading-anchor-permalink" href="#Infinite-endpoints" title="Permalink"></a></h2><p>Values and derivatives at <span>$\pm\infty$</span> should provide the correct limits.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using SpectralKit</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; basis = Chebyshev(InteriorGrid(), 4) ∘ InfRational(0.0, 1.0)</code><code class="nohighlight hljs ansi" style="display:block;">SpectralKit.TransformedBasis{Chebyshev{InteriorGrid}, InfRational{Float64}}(Chebyshev polynomials (1st kind), InteriorGrid(), dimension: 4, (-∞,∞) ↔ domain [rational transformation with center 0.0, scale 1.0])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; collect(basis_at(basis, 𝑑(Inf)))</code><code class="nohighlight hljs ansi" style="display:block;">4-element Vector{SpectralKit.𝑑Expansion{2, Float64}}:
 1.0 + 0.0⋅Δ
 1.0 + 0.0⋅Δ
 1.0 + 0.0⋅Δ
 1.0 + 0.0⋅Δ</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; collect(basis_at(basis, 𝑑(-Inf)))</code><code class="nohighlight hljs ansi" style="display:block;">4-element Vector{SpectralKit.𝑑Expansion{2, Float64}}:
 1.0 + 0.0⋅Δ
 -1.0 + 0.0⋅Δ
 1.0 + -0.0⋅Δ
 -1.0 + 0.0⋅Δ</code></pre><h2 id="Constructing-bases"><a class="docs-heading-anchor" href="#Constructing-bases">Constructing bases</a><a id="Constructing-bases-1"></a><a class="docs-heading-anchor-permalink" href="#Constructing-bases" title="Permalink"></a></h2><h3 id="Grid-specifications"><a class="docs-heading-anchor" href="#Grid-specifications">Grid specifications</a><a id="Grid-specifications-1"></a><a class="docs-heading-anchor-permalink" href="#Grid-specifications" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.EndpointGrid" href="#SpectralKit.EndpointGrid"><code>SpectralKit.EndpointGrid</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct EndpointGrid &lt;: SpectralKit.AbstractGrid</code></pre><p>Grid that includes endpoints (eg Gauss-Lobatto).</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>For small dimensions may fall back to a grid that does not contain endpoints.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/generic_api.jl#L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.InteriorGrid" href="#SpectralKit.InteriorGrid"><code>SpectralKit.InteriorGrid</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct InteriorGrid &lt;: SpectralKit.AbstractGrid</code></pre><p>Grid with interior points (eg Gauss-Chebyshev).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/generic_api.jl#L169">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.InteriorGrid2" href="#SpectralKit.InteriorGrid2"><code>SpectralKit.InteriorGrid2</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct InteriorGrid2 &lt;: SpectralKit.AbstractGrid</code></pre><p>Grid with interior points that results in smaller grids than <code>InteriorGrid</code> when nested. Equivalent to an <code>EndpointGrid</code> with endpoints dropped.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/generic_api.jl#L186">source</a></section></article><h3 id="Domains-and-transformations"><a class="docs-heading-anchor" href="#Domains-and-transformations">Domains and transformations</a><a id="Domains-and-transformations-1"></a><a class="docs-heading-anchor-permalink" href="#Domains-and-transformations" title="Permalink"></a></h3><p>A transformation maps values between a <em>domain</em>, usually specified by the basis, and the (co)domain that is specified by a transformation. Transformations are not required to be subtypes of anything, but need to support</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.transform_to" href="#SpectralKit.transform_to"><code>SpectralKit.transform_to</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>transform_to(domain, transformation, x)</code></p><p>Transform <code>x</code> to <code>domain</code> using <code>transformation</code>.</p><p><code>domain</code> can be replaced by <code>basis</code> for a shortcut which uses <code>domain(basis)</code>.</p><p>Transformations to infinity make sure that <span>$\pm\infty$</span> is mapped to the limit for values and derivatives.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/transformations.jl#L29-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.transform_from" href="#SpectralKit.transform_from"><code>SpectralKit.transform_from</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>transform_from(domain, transformation, x)</code></p><p>Transform <code>x</code> from <code>domain</code> using <code>transformation</code>.</p><p><code>domain</code> can be replaced by <code>basis</code> for a shortcut which uses <code>domain(basis)</code>.</p><p>Transformations to infinity make sure that <span>$\pm\infty$</span> is mapped to the limit for values and derivatives.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/transformations.jl#L41-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.domain" href="#SpectralKit.domain"><code>SpectralKit.domain</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>domain(basis)</code></p><p>The domain of a function basis.</p><p><code>domain(transformation)</code></p><p>The (co)domain of a transformation. The “other” domain (codomain, depending on the mapping) is provided explicitly for transformations, and should be compatible with the<code>domain</code> of the basis.</p><p>See <a href="#SpectralKit.domain_kind"><code>domain_kind</code></a> for the interface supported by domains.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/generic_api.jl#L54-L66">source</a></section></article><p>In most cases you do not need to specify a domain directly: transformations specify their domains (eg from <span>$(0, ∞)$</span>), and the codomain is determined by a basis. However, the following can be used to construct and query some concrete domains.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.domain_kind" href="#SpectralKit.domain_kind"><code>SpectralKit.domain_kind</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">domain_kind(x)
</code></pre><p>Return the <em>kind</em> of a domain type (preferred) or value. Errors for objects/types which are not domains. Also works for domains of transformations.</p><p>The following return values are possible:</p><ol><li><code>:univariate</code>, the bounds of which can be accessed using <code>minimum</code>, <code>maximum</code>, and</li></ol><p><code>extrema</code>,</p><ol><li><code>:multivariate</code>, which supports <code>length</code>, <code>getindex</code> (<code>[]</code>), and conversion with <code>Tuple</code>.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/domains.jl#L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.coordinate_domains" href="#SpectralKit.coordinate_domains"><code>SpectralKit.coordinate_domains</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">coordinate_domains(domains)
</code></pre><p>Create domains which are the product of univariate domains. The result support <code>length</code>, indexing with integers, and <code>Tuple</code> for conversion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/domains.jl#L111">source</a></section><section><div><pre><code class="language-julia hljs">coordinate_domains(domains)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/domains.jl#L121">source</a></section><section><div><pre><code class="language-julia hljs">coordinate_domains(_, domain)
</code></pre><p>Create a coordinate domain which is the product of <code>domain</code> repeated <code>N</code> times.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/domains.jl#L128">source</a></section><section><div><pre><code class="language-julia hljs">coordinate_domains(N, domain)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/domains.jl#L138">source</a></section></article><p>Bases are defined on a <em>canonical domain</em>, such as <span>$[-1, 1]$</span> for Chebyshev polynomials. <em>Transformations</em> map other uni- and multivariate sets into these domains.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.BoundedLinear" href="#SpectralKit.BoundedLinear"><code>SpectralKit.BoundedLinear</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct BoundedLinear{T&lt;:Real} &lt;: SpectralKit.AbstractUnivariateTransformation</code></pre><p>Transform the domain to <code>y ∈ (a, b)</code>, using <span>$y = x ⋅ s + m$</span>.</p><p><code>m</code> and <code>s</code> are calculated and checked by the constructor; <code>a &lt; b</code> is enforced.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/transformations.jl#L169">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.InfRational" href="#SpectralKit.InfRational"><code>SpectralKit.InfRational</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">InfRational(A, L)
</code></pre><p>The domain transformed to <code>(-Inf, Inf)</code> using <span>$y = A + L ⋅ x / √(1 - x^2)$</span>, with <code>L &gt; 0</code>.</p><p><strong>Example mappings (for domain <span>$(-1,1)$</span>)</strong></p><ul><li><span>$0 ↦ A$</span></li><li><span>$±0.5 ↦ A ± L / √3$</span></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/transformations.jl#L297">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.SemiInfRational" href="#SpectralKit.SemiInfRational"><code>SpectralKit.SemiInfRational</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SemiInfRational(A, L)
</code></pre><p>The domian transformed to  <code>[A, Inf)</code> (when <code>L &gt; 0</code>) or <code>(-Inf,A]</code> (when <code>L &lt; 0</code>) using <span>$y = A + L ⋅ (1 + x) / (1 - x)$</span>.</p><p>When used with Chebyshev polynomials, also known as a “rational Chebyshev” basis.</p><p><strong>Example mappings for the domain <span>$(-1,1)$</span></strong></p><ul><li><span>$-1/2 ↦ A + L / 3$</span></li><li><span>$0 ↦ A + L$</span></li><li><span>$1/2 ↦ A + 3 ⋅ L$</span></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/transformations.jl#L228">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.coordinate_transformations" href="#SpectralKit.coordinate_transformations"><code>SpectralKit.coordinate_transformations</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">coordinate_transformations(transformations)
</code></pre><p>Wrapper for coordinate-wise transformations. To extract components, convert to Tuple.</p><pre><code class="language-julia-repl hljs">julia&gt; using StaticArrays

julia&gt; ct = coordinate_transformations(BoundedLinear(0, 2), SemiInfRational(2, 3))
coordinate transformations
  (0.0,2.0) ↔ domain [linear transformation]
  (2,∞) ↔ domain [rational transformation with scale 3]

julia&gt; d1 = domain(Chebyshev(InteriorGrid(), 5))
[-1,1]

julia&gt; dom = coordinate_domains(d1, d1)
[-1,1]²

julia&gt; x = transform_from(dom, ct, (0.4, 0.5))
(1.4, 11.0)

julia&gt; y = transform_to(dom, ct, x)
(0.3999999999999999, 0.5)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/transformations.jl#L80">source</a></section></article><h3 id="Univariate-bases"><a class="docs-heading-anchor" href="#Univariate-bases">Univariate bases</a><a id="Univariate-bases-1"></a><a class="docs-heading-anchor-permalink" href="#Univariate-bases" title="Permalink"></a></h3><p>Currently, only Chebyshev polynomials are implemented. Univariate bases operate on real numbers.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.Chebyshev" href="#SpectralKit.Chebyshev"><code>SpectralKit.Chebyshev</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct Chebyshev{K&lt;:SpectralKit.AbstractGrid} &lt;: SpectralKit.UnivariateBasis</code></pre><p>The first <code>N</code> Chebyhev polynomials of the first kind, defined on <code>[-1,1]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/chebyshev.jl#L7">source</a></section></article><h3 id="Multivariate-bases"><a class="docs-heading-anchor" href="#Multivariate-bases">Multivariate bases</a><a id="Multivariate-bases-1"></a><a class="docs-heading-anchor-permalink" href="#Multivariate-bases" title="Permalink"></a></h3><p>Multivariate bases operate on tuples or vectors (<code>StaticArrays.SVector</code> is preferred for performance, but all <code>&lt;:AbstractVector</code> types should work).</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.SmolyakParameters" href="#SpectralKit.SmolyakParameters"><code>SpectralKit.SmolyakParameters</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SmolyakParameters(B)
SmolyakParameters(B, M)
</code></pre><p>Parameters for Smolyak grids that are <em>independent of the dimension of the domain</em>.</p><p>Polynomials are organized into blocks (of eg <code>1, 2, 2, 4, 8, 16, …</code>) polynomials (and corresponding gridpoints), indexed with a <em>block index</em> <code>b</code> that starts at <code>0</code>. <code>B ≥ ∑ bᵢ</code> and <code>0 ≤ bᵢ ≤ M</code> constrain the number of blocks along each dimension <code>i</code>.</p><p><code>M &gt; B</code> is not an error, but will be normalized to <code>M = B</code> with a warning.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/smolyak_traversal.jl#L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.smolyak_basis" href="#SpectralKit.smolyak_basis"><code>SpectralKit.smolyak_basis</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">smolyak_basis(
    univariate_family,
    grid_kind,
    smolyak_parameters,
    _
)
</code></pre><p>Create a sparse Smolyak basis.</p><p><strong>Arguments</strong></p><ul><li><p><code>univariate_family</code>: should be a callable that takes a <code>grid_kind</code> and a <code>dimension</code> parameter, eg <code>Chebyshev</code>.</p></li><li><p><code>grid_kind</code>: the grid kind, eg <code>InteriorGrid()</code> etc.</p></li><li><p><code>smolyak_parameters</code>: the Smolyak grid specification parameters, see <a href="#SpectralKit.SmolyakParameters"><code>SmolyakParameters</code></a>.</p></li><li><p><code>N</code>: the dimension. wrapped in a <code>Val</code> for type stability, a convenience constructor also takes integers.</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; basis = smolyak_basis(Chebyshev, InteriorGrid(), SmolyakParameters(3), 2)
Sparse multivariate basis on ℝ²
  Smolyak indexing, ∑bᵢ ≤ 3, all bᵢ ≤ 3, dimension 81
  using Chebyshev polynomials (1st kind), InteriorGrid(), dimension: 27

julia&gt; dimension(basis)
81

julia&gt; domain(basis)
[-1,1]²</code></pre><p><strong>Properties</strong></p><p><em>Grids nest</em>: increasing arguments of <code>SmolyakParameters</code> result in a refined grid that contains points of the cruder grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/smolyak_api.jl#L25">source</a></section></article><h2 id="Using-bases"><a class="docs-heading-anchor" href="#Using-bases">Using bases</a><a id="Using-bases-1"></a><a class="docs-heading-anchor-permalink" href="#Using-bases" title="Permalink"></a></h2><h3 id="Introspection"><a class="docs-heading-anchor" href="#Introspection">Introspection</a><a id="Introspection-1"></a><a class="docs-heading-anchor-permalink" href="#Introspection" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.is_function_basis" href="#SpectralKit.is_function_basis"><code>SpectralKit.is_function_basis</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>is_function_basis(::Type{F})</code></p><p><code>is_function_basis(f::F)</code></p><p>Test if the argument (value or type) is a <em>function basis</em>, supporting the following interface:</p><ul><li><p><a href="#SpectralKit.domain"><code>domain</code></a> for querying the domain,</p></li><li><p><a href="#SpectralKit.dimension"><code>dimension</code></a> for the dimension,</p></li><li><p><a href="#SpectralKit.basis_at"><code>basis_at</code></a> for function evaluation,</p></li><li><p><a href="#SpectralKit.grid"><code>grid</code></a> to obtain collocation points.</p></li><li><p><code>length</code> and <code>getindex</code> for multivariate bases <code>(domain_kind(domain(basis)) == :multivariate)</code>, getindex returns a compatible marginal basis</p></li></ul><p><a href="#SpectralKit.linear_combination"><code>linear_combination</code></a> and <a href="#SpectralKit.collocation_matrix"><code>collocation_matrix</code></a> are also supported, building on the above.</p><p>Can be used on both types (preferred) and values (for convenience).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/generic_api.jl#L24-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.dimension" href="#SpectralKit.dimension"><code>SpectralKit.dimension</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>dimension(basis)</code></p><p>Return the dimension of <code>basis</code>, a positive <code>Int</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/generic_api.jl#L69-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.transformation" href="#SpectralKit.transformation"><code>SpectralKit.transformation</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transformation(basis)
</code></pre><p>Return the transformation of transformed bases, or <code>nothing</code> it not applicable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/generic_api.jl#L278">source</a></section></article><p>See also <a href="#SpectralKit.domain"><code>domain</code></a>.</p><h3 id="Evaluation"><a class="docs-heading-anchor" href="#Evaluation">Evaluation</a><a id="Evaluation-1"></a><a class="docs-heading-anchor-permalink" href="#Evaluation" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.basis_at" href="#SpectralKit.basis_at"><code>SpectralKit.basis_at</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>basis_at(basis, x)</code></p><p>Return an iterable with known element type and length (<code>Base.HasEltype()</code>, <code>Base.HasLength()</code>) of basis functions in <code>basis</code> evaluated at <code>x</code>.</p><p>Univariate bases operate on real numbers, while for multivariate bases, <code>Tuple</code>s or <code>StaticArrays.SVector</code> are preferred for performance, though all <code>&lt;:AbstractVector</code> types should work.</p><p>Methods are type stable.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Consequences are undefined when evaluating outside the domain.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/generic_api.jl#L76-L90">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.linear_combination" href="#SpectralKit.linear_combination"><code>SpectralKit.linear_combination</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">linear_combination(basis, θ, x)
</code></pre><p>Evaluate the linear combination of <span>$∑ θₖ⋅fₖ(x)$</span> of function basis <span>$f₁, …$</span> at <code>x</code>, for the given order.</p><p>The length of <code>θ</code> should equal <code>dimension(θ)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/generic_api.jl#L130">source</a></section><section><div><pre><code class="language-julia hljs">linear_combination(basis, θ)
</code></pre><p>Return a callable that calculates <code>linear_combination(basis, θ, x)</code> when called with <code>x</code>.</p><p>You can use <code>linear_combination(basis, θ) ∘ transformation</code> for domain transformations, though working with <code>basis ∘ transformation</code> may be preferred.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/generic_api.jl#L152">source</a></section></article><h3 id="Grids-and-collocation"><a class="docs-heading-anchor" href="#Grids-and-collocation">Grids and collocation</a><a id="Grids-and-collocation-1"></a><a class="docs-heading-anchor-permalink" href="#Grids-and-collocation" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.grid" href="#SpectralKit.grid"><code>SpectralKit.grid</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>grid([T], basis)</code></p><p>Return an iterator for the grid recommended for collocation, with <code>dimension(basis)</code> elements.</p><p><code>T</code> for the element type of grid coordinates, and defaults to <code>Float64</code>. Methods are type stable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/generic_api.jl#L194-L202">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.collocation_matrix" href="#SpectralKit.collocation_matrix"><code>SpectralKit.collocation_matrix</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">collocation_matrix(basis)
collocation_matrix(basis, x)
</code></pre><p>Convenience function to obtain a “collocation matrix” at points <code>x</code>, which is assumed to have a concrete <code>eltype</code>. The default is <code>x = grid(basis)</code>, specialized methods may exist for this when it makes sense.</p><p>The collocation matrix may not be an <code>AbstractMatrix</code>, all it needs to support is <code>C \ y</code> for compatible vectors <code>y = f.(x)</code>.</p><p>Methods are type stable. The elements of <code>x</code> can be derivatives, see <a href="#SpectralKit.𝑑"><code>𝑑</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/generic_api.jl#L205">source</a></section></article><h3 id="Augment-coordinates-for-a-wider-basis"><a class="docs-heading-anchor" href="#Augment-coordinates-for-a-wider-basis">Augment coordinates for a wider basis</a><a id="Augment-coordinates-for-a-wider-basis-1"></a><a class="docs-heading-anchor-permalink" href="#Augment-coordinates-for-a-wider-basis" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.augment_coefficients" href="#SpectralKit.augment_coefficients"><code>SpectralKit.augment_coefficients</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>augment_coefficients(basis1, basis2, θ1)</code></p><p>Return a set of coefficients <code>θ2</code> for <code>basis2</code> such that</p><pre><code class="language-julia hljs">linear_combination(basis1, θ1, x) == linear_combination(basis2, θ2, x)</code></pre><p>for any <code>x</code> in the domain. In practice this means padding with zeros.</p><p>Throw a <code>ArgumentError</code> if the bases are incompatible with each other or <code>x</code>, or this is not possible. Methods may not be defined for incompatible bases, compatibility between bases can be checked with <a href="#SpectralKit.is_subset_basis"><code>is_subset_basis</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/generic_api.jl#L229-L241">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.is_subset_basis" href="#SpectralKit.is_subset_basis"><code>SpectralKit.is_subset_basis</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">is_subset_basis(basis1, basis2)
</code></pre><p>Return a <code>Bool</code> indicating whether coefficients in <code>basis1</code> can be augmented to <code>basis2</code> with <a href="#SpectralKit.augment_coefficients"><code>augment_coefficients</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><code>true</code> does not mean that coefficients from <code>basis1</code> can just be padded with zeros, since they may be in different positions. Always use <a href="#SpectralKit.augment_coefficients"><code>augment_coefficients</code></a>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/generic_api.jl#L244">source</a></section></article><h2 id="Derivatives"><a class="docs-heading-anchor" href="#Derivatives">Derivatives</a><a id="Derivatives-1"></a><a class="docs-heading-anchor-permalink" href="#Derivatives" title="Permalink"></a></h2><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>API for derivatives is still experimental and subject to change.</p></div></div><p>For univariate functions, use <a href="#SpectralKit.𝑑"><code>𝑑</code></a>. For multivariate functions, use partial derivatives with <a href="#SpectralKit.∂"><code>∂</code></a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.𝑑" href="#SpectralKit.𝑑"><code>SpectralKit.𝑑</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A callable that calculates the value and the derivative of the argument. Higher-order derivatives can be obtained by using an exponent, or multiplication.</p><pre><code class="language-julia-repl hljs">julia&gt; 𝑑(2.0)
2.0 + 1.0⋅Δ

julia&gt; (𝑑^3)(2.0)
2.0 + 1.0⋅Δ + 0.0⋅Δ² + 0.0⋅Δ³</code></pre><p>Note that non-literal exponentiation requires <code>^Val(y)</code>, for type stability.</p><p>See <a href="#SpectralKit.linear_combination"><code>linear_combination</code></a> for examples of evaluating derivatives of basis functions and linear combinations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/derivatives.jl#L76-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.∂" href="#SpectralKit.∂"><code>SpectralKit.∂</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">∂(I)
</code></pre><p>Partial derivatives along the given coordinates.</p><p>!!! NOTE     Partial derivatives are currently <strong>experimental</strong> and not heavily tested. API may     change at any point without prior notice or deprecation.</p><p>The following are equivalent, and represent <span>$\partial_1 \partial^2_2$</span>, ie the first derivative along the first axis, and the second partial derivative along the second axis.</p><pre><code class="language- hljs">julia&gt; ∂(1, 2)
∂(1, 2)

julia&gt; ∂((1, 2))
∂(1, 2)</code></pre><p>Only the vararg form allows trailing zeros, which are stripped:</p><pre><code class="language- hljs">julia&gt; ∂(1, 0)
∂(1)

julia&gt; ∂((1, 0))
ERROR: ArgumentError: I ≡ () || last(I) ≠ 0 must hold.</code></pre><p>Use the empty form for no derivatives:</p><pre><code class="language- hljs">julia&gt; ∂()
∂()</code></pre><p>Combine derivatives using <code>union</code> or <code>∪</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; ∂(1, 2) ∪ ∂(2, 1)
union(∂(2, 1), ∂(1, 2))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/derivatives.jl#L360">source</a></section></article><h2 id="Internals"><a class="docs-heading-anchor" href="#Internals">Internals</a><a id="Internals-1"></a><a class="docs-heading-anchor-permalink" href="#Internals" title="Permalink"></a></h2><p>This section of the documentation is probably only relevant to contributors and others who want to understand the internals.</p><h3 id="Type-hierarchies"><a class="docs-heading-anchor" href="#Type-hierarchies">Type hierarchies</a><a id="Type-hierarchies-1"></a><a class="docs-heading-anchor-permalink" href="#Type-hierarchies" title="Permalink"></a></h3><p>Generally, the abstract types below are not part of the exposed API, and new types don&#39;t have to subtype them (unless they want to rely on the existing convenience methods). They are merely for code organization.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.AbstractUnivariateDomain" href="#SpectralKit.AbstractUnivariateDomain"><code>SpectralKit.AbstractUnivariateDomain</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Univariate domain representation. Supports <code>extrema</code>, <code>minimum</code>, <code>maximum</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Implementations only need to define <code>extrema</code>.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/domains.jl#L32-L37">source</a></section></article><h3 id="Grid-internals"><a class="docs-heading-anchor" href="#Grid-internals">Grid internals</a><a id="Grid-internals-1"></a><a class="docs-heading-anchor-permalink" href="#Grid-internals" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpectralKit.gridpoint" href="#SpectralKit.gridpoint"><code>SpectralKit.gridpoint</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gridpoint(_, basis, i)
</code></pre><p>Return a gridpoint for collocation, with <code>1 ≤ i ≤ dimension(basis)</code>.</p><p><code>T</code> is used <em>as a hint</em> for the element type of grid coordinates. The actual type can be broadened as required. Methods are type stable.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Not all grids have this method defined, especially if it is impractical. See <a href="#SpectralKit.grid"><code>grid</code></a>, which is part of the API, this function isn&#39;t.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tpapp/SpectralKit.jl/blob/d9b997c8b7d8ec3cb268c8cd314e130981e4da06/src/chebyshev.jl#L76">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Monday 9 December 2024 14:18">Monday 9 December 2024</span>. Using Julia version 1.10.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
